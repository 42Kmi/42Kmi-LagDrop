***** 42Kmi LagDrop *****

Inspired by the frustration of online lag, 42Kmi LagDrop is a suite of router scripts to
experience lag-free gameplay in online console games utilizing peer-to-peer matchmaking. 



Changes
Version 2.0.8 - 2016-12-28
- Fixed RestOnMultiplayer, RestOnMultiplayer will disable Sentinel from acting.
- New enable/disable array method implemented

Version 2.0.7 - 2016-12-19
- Parenthetical grouping for port filtering
- Fixed error when creating options.txt file on initiation

Version 2.0.6 - 2016-12-15
- Hash gengation: Items following # in options.txt will be ignored inline. Useful for testing new values without losing old values
- Rest on Multiplayer: LagDrop will pause testing if the number of concurrent connections to your console is greater than a given value. Only effective when relevant peers are connected. Make sure the proper filters are in place so only relevante peers can be viewed by LagDrop. Can be enabled/disabled.
- runlagdrop.sh will read options.txt for SWITCH value, halts function and kills LagDrop when SWITCH is off.
- Corrected issue with CHECKPACKETLOSS.

Version 2.0.5 - 2016-12-11
- Adjusted reading from blacklist.txt and whitelist.txt
- Removed "blacklist/whitelist correction" module from LagDrop scripts.
- Semantic versioning added to runlagdrop.sh and lagdropkill.sh, which will reflect version number for main LagDrop script when significant changes were made to either runlagdrop.sh or lagdropkill.sh
- Changes to runlagdrop.sh; was causing CPU spikes. Now self-terminates if LagDrop script is detected; re-enabled lockfile for runlagdrop.sh to prevent parallel execution.
- Fixed lagdropkill.sh script
- Added port filtering. Good for PC. When enabled, LagDrop will limit testing of IP addresses to those sending to the identifed destination port. Port ranges can be added in regular expression to the Port line in options.txt. E.g. PORT=3659|(46[0-9]{3}|5[0-4][0-9]{3}

Version 2.0.4 - 2016-11-28
- Adjusted an issue with CPU spikes.

Version 2.0.3 - 2016-11-27
- Caught an error. My bad. Should be fixed now.
- Amazon AWS IP list in regex available. Add it to your whitelist.txt to filter servers dependent on Amazon AWS from being tested by LagDrop.
- Amazon AWS IPs added to lagdrop_wiiu.sh and lagdrop_3ds.sh. Nintendo uses Amazon servers.

Version 2.0.2 - 2016-11-21
- Changed filter.txt to whitelist.txt; added blacklist function with blacklist.txt Rules for blacklist.txt are written similarly to whitelist.txt. IP addresses in blacklist.txt are always blocked.
- More optimizations.
- PlayStation version of LagDrop is here!
- Use lagdrop script suffix as argument for runlagdrop.sh when added to cron.

Version 2.0.0 - 2016-11-14
- Fixed function of SWITCH, now works as it should.
- Added sentinel, continuously checks most recent allowed peer for packet loss. If packet loss occurs, peer is blocked.
- Added feature to clear our cached peers after.
- Optimization: removed multiple instances of ping. Retrieves info for ping and packet loss tests from same ping info stored in memory
- Optimization: Settings stored to memory, read once per run.
- Optimization: IP connections list presorted early and stored to memory, read once per run.
- Corrected ping tests results from being based on maximum ping time to the average ping time.
- Additional IPs to ignore should be added to filter.txt file file in 42Kmi folder (formally the extraip.txt file). This change was made for clarifaction sake.

Version 1.7.8 - 2016-10-30
- Added Packet Loss Test option: Blocks peer if packet loss greater than indicated percent is detected, has priority over regular Ping and Trace Route tests. Default is off and 80 (percent).
- Changed how LagDrop handles extraip.txt file. Now IP addresses can be added in formatted single lines, which IP address separated by pipes (|) (like Regular Expression) or they can be added to separate lines. Titles/Headings can be added to group IP addresses, title/headings must be on one line surrounded by # (eg, #This is a Heading#). Last line in extraip.txt must be blank, a semicolon or contain #.
- Auto-initialize iptables FORWARD table for LagDrop work.

Version 1.7.7 - 2016-10-15
- Randomized packets sent for ping test.
- Fixed lagdropclear.sh
- Added lagdropcount.sh for counting allowed and blocked peers

Version 1.7.6 - 2016-10-04
- Added new Nintendo server IP for WiiU and 3DS LagDrop scripts
- Added clear toggle to lagdropclear.sh;  Defalut (0) clears LDACCEPT and LDREJECT lists, 1 clears LDACCEPT list only. Open in text editor to adjust setting.

Version 1.7.5 - 2016-09-15
- Improved loopback function. Script now uses function redundancy within script instead of executing script again at termination of script. Just initiate once.
- Fixed intiation process to limit LagDrop specific tables creation to one in iptables
- Added LagDrop kill script. Just run lagdropkill.sh to terminate all scripts with lagdrop in their names.

Version 1.7.4 - 2016-09-01
- Minor change to ignore function. Corrected a previously overlooked error.
- Removed wait time restart script. Faster testing of peers.
- Started adding dates to change log. 

Version 1.7.3 - 2016-08-24
- Fixed master switch function to exit script instead of "truing"
- Added action select. User can choose to REJECT (0) peers (default action) or DROP (1) them.

Version 1.7.2 - 2016-08-18
- Added master switch to allow easy toggling of LagDrop. 1 to enable, 0 to disable. Default is 1. Set in the options.txt file

Version 1.7.1 - 2016-08-09
-Corrected an error in TraceRoute average calculation that divided summed times by one less than the number of recorded times.

Version 1.7.0 - 2016-08-07
- Changed lag metric from Ping mdev to Ping avg
- Changes to default settings.
- Removed clear interval from lagdrop.sh
- Added mode selection! Determine who to block by different tests. 1 for Ping, 2 for TraceRoute, 3 for Ping or TraceRoute, 4 for Ping and TraceRoute
- Added editable parameters for TraceRoute tests: Max TTL, Probes, Trace Limit

Version 1.6.2
- Adjusted WAN and LAN filters to escape "." for regex
- Removed some unecessary spaces from command options. 16 bytes smaller!

Version 1.6.1
- Adjusted WAN and LAN filters

Version 1.6.0 - 2016-07-16
-More efficient. Only new peer IPs are checked.

Version 1.5.0 - 2016-06-27
-Fixed redundancy issue. More efficient iptables rules handling.
-Prevent peer IP pinging if peer IP is already in iptables
-LagDrop now sets rules to its own chain to prevent interference with user's other existing iptable rules

Version 1.4.1
-Reverted DROP to REJECT

Version 1.4.0 - 2016-06-24
-Minor fixes...

Version 1.3.1 - 2016-06-23
-REJECT to DROP

Version 1.3.0 - 2016-06-18
-User-defined periodic clearing of LagDrop iptables entries

Version 1.2.1 - 2016-06-17
-Minor changes for stability

Version 1.2.0 - 2016-06-16
-Prevent pinging of checked IPs
-Increased frequency of IP checks

Version 1.1.1 - 2016-06-14
-Minor IP block fix

Version 1.1.0 - 2016-06-14
- Fixed redundant IP blocks.

Version 1.0.0 - 2016-06-13
- Fixed issue causing router crash
- Added conditional filter of additional IP address by user via extraip.txt
- Included Xbox One version

Version 0.9.0 - 2016-04-03
Minor fix in getting IP addresses
Fixed lagrop.startup

Version 0.8.0 - 2016-04-02
- Semantic versioning begining with this release.
- Change log
- lagdrop.sh renamed to lagdrop_wiiu.sh, and script is adjusted to reflect those changes
- lagdrop_3DS.sh renamed to lagdrop_3ds.sh, and script is adjusted to reflect those changes
- Different scripts combined into one suite
- Includes lagdrop.startup script to launch different versions consecutively
- Fixed loop control
- Scripts are now directory agnostic, can be run from any directory where lagdrop script is located.
